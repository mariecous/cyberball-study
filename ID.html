<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Cyberball – version animée</title>
<style>
  body { font-family: sans-serif; text-align: center; background: #ececec; }
  canvas { margin-top: 20px; background: white; border: 2px solid #333; cursor: pointer; }
  .hidden { display: none; }
  button { padding: 12px 25px; background: #007bff; border: none; border-radius: 10px; font-size: 18px; color: white; cursor: pointer; }
</style>
</head>
<body>

<div id="welcome">
  <h1>Bienvenue dans l'étude Cyberball</h1>
  <p id="instructions">Nous vous remercions de votre participation à cette expérience scientifique. Notez que toutes les données récoltées durant cette session seront traitées de manière strictement anonyme et confidentielle</p>
  <p>1) Conservez votre identifiant ci-dessous.<br>2) Répondez au premier questionnaire avec cet identifiant.<br>3) Revenez faire le Cyberball.<br>4) Répondez au second questionnaire avec le MÊME identifiant.</p>

  <h2>Votre identifiant :</h2>
  <div id="identifier" style="font-size:26px;font-weight:bold;margin:10px;"><span id="generatedID"></span></div>

 <a href="https://questionnaires.univ-nantes.fr/index.php/732818?lang=fr" class="btn-questionnaire">
  Répondre au questionnaire
</a>

<style>
  .btn-questionnaire {
    display: inline-block;
    padding: 10px 18px;
    background-color: #007BFF; /* Bleu */
    color: white;
    text-decoration: none;
    border-radius: 6px;
    font-weight: bold;
  }

  .btn-questionnaire:hover {
    background-color: #0056b3;
  }
</style>

    
  <div id="consignes">
    <p> Vous allez maintenant prendre part à un exercice de visualisation mentale sous la forme d'un jeu de balle virtuel. Vous jouerez avec deux autres participants connectés à distance. Lorsque vous recevez la balle, relancez-la simplement à la personne de votre choix en cliquant sur son avatar.<br> <br>Pendant toute la durée du jeu, essayez de vous représenter mentalement la situation. Une fois la partie terminée, il vous sera demandé de répondre à un court questionnaire.<p/>
   <button id="goCyber">Passer au Cyberball</button>
  </div>

<h1 id="title" class="hidden">CYBERBALL</h1>
<p id="instructions" class="hidden">Nous vous remercions de votre participation. Cliquez sur “Commencer”.</p>
<button id="startBtn" class="hidden">Commencer</button>

<div id="playerSelect" class="hidden"><h2>Choisissez votre personnage</h2></div>
<div id="loading" class="hidden"><h2>Recherche des autres joueurs…</h2><p>Veuillez patienter…</p></div>
<canvas id="canvas" width="600" height="420" class="hidden"></canvas>

<div id="questionnaire" class="hidden">
  <h2>Merci d'avoir joué !</h2>
  <p>Veuillez répondre au questionnaire ci-dessous :</p>
  <button onclick="window.open('https://questionnaires.univ-nantes.fr/index.php/469666?lang=fr', '_blank')">Accéder au questionnaire</button>
</div>

<div id="debrief" class="hidden"><h2>Merci pour votre participation !</h2></div>

<script>
// ---- Génération ID ----
function generateID() {
  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
  const num = Math.floor(1000 + Math.random() * 9000);
  const letter = chars[Math.floor(Math.random() * chars.length)];
  return num + letter;
}
const id = generateID();
document.getElementById('generatedID').textContent = id;
localStorage.setItem('cyberballID', id);

// ---- Raccourcis éléments ----
const goCyber = document.getElementById('goCyber');
const startBtn = document.getElementById('startBtn');
const instructions = document.getElementById('instructions');
const title = document.getElementById('title');
const playerSelect = document.getElementById('playerSelect');
const loading = document.getElementById('loading');
const questionnaire = document.getElementById('questionnaire');
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

// ---- Navigation ----
goCyber.onclick = () => {
  document.getElementById('welcome').classList.add('hidden');
  title.classList.remove('hidden');
  instructions.classList.remove('hidden');
  startBtn.classList.remove('hidden');
};

startBtn.onclick = () => {
  instructions.classList.add('hidden');
  startBtn.classList.add('hidden');
  playerSelect.classList.remove('hidden');
  drawSelectionScreen();
};

// ---- Personnages simplifiés (même style que version précédente) ----
const allCharacters = [
  { name: "Personnage 1", skin: "#f2d3b1", hair: "#7a4a1e", shirt: "#e6e6e6", pants: "#555" },
  { name: "Personnage 2", skin: "#f2d3b1", hair: "#c85a50", shirt: "#f7d87f", pants: "#f7d87f" },
  { name: "Personnage 3", skin: "#b88a65", hair: "#3f332a", shirt: "#7fc8f7", pants: "#666" },
  { name: "Personnage 4", skin: "#9a6a4a", hair: "#3f332a", shirt: "#c85a50", pants: "#333" },
  { name: "Personnage 5", skin: "#f2d3b1", hair: "#777", shirt: "#e86a5d", pants: "#5a4a42" }
];

function drawCharacter(p) {
  ctx.save(); ctx.translate(p.x, p.y);
  ctx.fillStyle = p.shirt;
  ctx.fillRect(-20, 0, 40, 55);
  ctx.fillStyle = p.skin;
  ctx.beginPath(); ctx.arc(0, -28, 18, 0, Math.PI*2); ctx.fill();
  ctx.fillStyle = p.hair;
  ctx.beginPath(); ctx.arc(0, -35, 18, Math.PI, Math.PI*2); ctx.fill();
  ctx.restore();
}

function drawSelectionScreen() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  canvas.classList.remove('hidden');
  let display = allCharacters.map((c,i)=>({ ...c, x:80+i*110, y:200 }));
  display.forEach(drawCharacter);
}
</script>
</body>

</html>








